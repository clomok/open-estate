{% extends 'base.html' %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 2rem;">
    <div>
        <h1 style="margin: 0; margin-bottom: 0.5rem;">{{ profile.name }}</h1>
        <div style="color: #666; font-size: 0.9rem;">
            Established: {{ profile.date_established or 'Date not set' }}
        </div>
    </div>
    <a href="{{ url_for('manage.edit_trust_profile') }}" style="background: #2563eb; color: white; text-decoration: none; padding: 0.5rem 1rem; border-radius: 4px; font-weight: 500;">
        Edit Trust Details
    </a>
</div>

<div class="grid-2-sidebar" style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;">
    
    <div>
        <div class="summary-card" style="margin-bottom: 2rem; border-left: 4px solid #f59e0b;">
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div>
                    <h3 style="margin-top: 0; color: #b45309;">Annual Review</h3>
                    <p style="margin-bottom: 1rem; color: #666;">
                        Schedule for reviewing assets, beneficiaries, and contact information.
                    </p>
                    <div style="display: grid; grid-template-columns: auto auto; gap: 2rem;">
                        <div>
                            <div style="font-size: 0.8rem; text-transform: uppercase; color: #999;">Frequency</div>
                            <div style="font-weight: bold; font-size: 1.1rem;">{{ profile.review_frequency }}</div>
                        </div>
                        <div>
                            <div style="font-size: 0.8rem; text-transform: uppercase; color: #999;">Next Scheduled</div>
                            <div style="font-weight: bold; font-size: 1.1rem; {% if profile.next_review_date %}color: #059669;{% endif %}">
                                {{ profile.next_review_date or 'Not Scheduled' }}
                            </div>
                        </div>
                    </div>
                </div>
                <div style="font-size: 2rem;">ðŸ“…</div>
            </div>
        </div>

        <div class="summary-card">
            <h3 style="margin-top: 0;">Trust Notes & Instructions</h3>
            {% if profile.notes %}
                <div style="white-space: pre-wrap; color: #374151; line-height: 1.6;">{{ profile.notes }}</div>
            {% else %}
                <p style="color: #999; font-style: italic;">No specific notes recorded.</p>
            {% endif %}
        </div>
    </div>

    <div>
        
        {% if profile.date_death_actual %}
        <div class="summary-card" style="background: #fee2e2; border: 1px solid #fca5a5; margin-bottom: 1.5rem;">
            <h3 style="margin-top: 0; color: #991b1b;">Transition Active</h3>
            <p style="font-size: 0.9rem; color: #7f1d1d;">
                Date of Passing recorded: <strong>{{ profile.date_death_actual }}</strong>.
                <br>The estate is now in administration/transition mode.
            </p>
        </div>
        {% endif %}

        <div class="summary-card" style="background: #f9fafb; border: 1px solid #e5e7eb;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                <h4 style="margin: 0; font-size: 0.9rem; text-transform: uppercase; color: #6b7280;">Planning Horizon</h4>
                <button onclick="toggleSensitive()" style="background: none; border: none; font-size: 0.8rem; color: #2563eb; cursor: pointer; text-decoration: underline;">Show/Hide</button>
            </div>
            
            <div id="sensitiveData" style="display: none; margin-top: 0.5rem;">
                <div style="font-size: 0.85rem; color: #666; margin-bottom: 0.25rem;">Est. Actuarial Date:</div>
                <div style="font-weight: bold; color: #374151;">
                    {{ profile.date_death_estimated or 'Not Set' }}
                </div>
                <p style="font-size: 0.75rem; color: #9ca3af; margin-top: 0.5rem; font-style: italic;">
                    This date is used solely for financial projection and maintenance timeline planning.
                </p>
            </div>
        </div>

    </div>
</div>

<script>
    function toggleSensitive() {
        const el = document.getElementById('sensitiveData');
        if (el.style.display === 'none') {
            el.style.display = 'block';
        } else {
            el.style.display = 'none';
        }
    }
</script>
{% endblock %}